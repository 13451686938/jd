<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="../img/icon/iconfont.css">
    <link rel="stylesheet" href="../css/index.css">
    <script src="../js/jquery.min.js"></script>
    <title>列表页</title>
</head>
<body>
    <header>
        <div class="headerwrap">
            <div class="headerLeft">
                <div>
                    <i class="iconfont icon-icon-test12"></i>
                    <span>北京</span>
                </div>
                <div></div>
            </div>
            <div class="headerRight">
                <ul>
                    <li><a href="login.html">你好,请登录</a></li>
                    <li><a href="register.html">免费注册</a></li>
                    <li><a href="#">我的订单</a></li>
                    <li ><a href="#">我的京东<span class="iconfont icon-icon-test60"></span></a></li>
                    <li><a href="#">京东会员</a></li>
                    <li ><a href="#">企业采购<span class="iconfont icon-icon-test60"></span></a></li>
                    <li ><a href="#">客户服务<span class="iconfont icon-icon-test60"></span></a></li>
                    <li ><a href="#">网站导航<span class="iconfont icon-icon-test60"></span></a></li>
                    <li><a href="#">手机京东</a></li>
                </ul>
            </div>
        </div>
    </header>

    <nav style="background:#fff;height:96px;">
        <div class = "navwrap" style="position:relative;"">
            <div style="position:absolute;left:32px;top:18px;""><img src="../img/img3.0/info/jdlogo.png" alt=""></div>
            <section>
                <div>
                    <input type="text" />
                    <span class = "iconfont icon-icon-test12"></span>
                </div>
                <div>
                    <span class = "iconfont icon-icon-test10"></span>
                    <i>我的购物车</i>
                    <em>0</em>
                </div>
                <div><img src="../img/erweima.png"/></div>
            </section>
            
        </div>
        <div class = "navHref">
            <ul>
                <li><a href="#">时尚运动鞋</a></li>
                <li><a href="#">汽车618</a></li>
                <li><a href="#">5件5折</a></li>
                <li><a href="#">赶猪器</a></li>
                <li><a href="#">内衣内裤</a></li>
                <li><a href="#">618</a></li>
                <li><a href="#">茶叶</a></li>
                <li><a href="#">减30元</a></li>
                <li><a href="#">居家爆款</a></li>
            </ul>
        </div>
    </nav>
    <div id="_img"><img src="../img/img3.0/info/long.jpg" alt="" style="margin-left:-214px;"></div>
    
    <div id="list">
        <!-- <li>
            <div class="list-img"><img src="../img/img3.0/list/tel1.jpg" alt=""> </div>
            <div class="list-id"></div>
            <div class="list-info">荣耀20i 3200万AI自拍 超广角三摄 全网通版6GB+64GB 渐变蓝 移动联通电信4G</div>
            <div class="list-price">￥1389.00</div>
        </li> -->
    </div>

    <footer>
        <ul>
            <li><i></i><span>多</span><h2>品类齐全,轻松购物</h2></li>
            <li><i></i><span>快</span><h2>多仓直升,极速配送</h2></li>
            <li><i></i><span>好</span><h2>正品行货,精致服务</h2></li>
            <li><i></i><span>省</span><h2>天天低价,畅选无忧</h2></li>	
        </ul>
    </footer>
    
    <div class="shopGuide">
        <a href="">
            <ul>
                <li style="margin-left:0;">购物指南
                    <dl>
                        <dd>购物流程</dd>
                        <dd>会员介绍</dd>
                        <dd>生活旅行</dd>
                        <dd>常见问题</dd>
                        <dd>大家电</dd>
                        <dd>联系客服</dd>
                    </dl>
                </li>
                <li>配送方式
                    <dl>
                        <dd>上门自提</dd>
                        <dd>211限时达</dd>
                        <dd>配送服务查询</dd>
                        <dd>配送费收取标准</dd>
                        <dd>海外配送</dd>
                    </dl>
                </li>
                <li>支付方式
                    <dl>
                        <dd>货到付款</dd>
                        <dd>在线支付</dd>
                        <dd>分期付款</dd>
                        <dd>邮局汇款</dd>
                        <dd>公司转账</dd>
                    </dl>
                </li>
                <li>售后服务
                    <dl>
                        <dd>售后政策</dd>
                        <dd>价格保护</dd>
                        <dd>退款说明</dd>
                        <dd>返修/退换货</dd>
                        <dd>取消订单</dd>
                    </dl>
                </li>
                <li>特色服务
                    <dl>
                        <dd>夺宝岛</dd>
                        <dd>DIY装机</dd>
                        <dd>延保服务</dd>
                        <dd>京东C 卡</dd>
                        <dd>京东通信</dd>
                        <dd>京鱼座智能 </dd>
                    </dl>
                </li>
                <li style="background-image: url(//misc.360buyimg.com/mtd/pc/index_2017/2.1.0/static/images/sprite.footer.png);">京东自营覆盖区县 
                    <p>京东已向全国2661个区县提供自营配送服务,支持货到付款 POS机刷卡和售后上门服务</p>
                    <h1>查看详情<span>></span></h1>
                </li>
            </ul>
        </a>
    </div>
    
    <div id="foot">
        <div class= "footWrap">
            <h1 style="margin-bottom: 18px;">
                <a href="#">关于我们<span>丨</span></a>
                <a href="#">联系我们<span>丨</span></a>
                <a href="#">联系客服<span>丨</span></a>
                <a href="#">合作招商<span>丨</span></a>
                <a href="#">商家帮助<span>丨</span></a>
                <a href="#">营销中心<span>丨</span></a>
                <a href="#">手机京东<span>丨</span></a>
                <a href="#">友情链接<span>丨</span></a>
                <a href="#">销售联盟<span>丨</span></a>
                <a href="#">京东社区<span>丨</span></a>
                <a href="#">风险监测<span>丨</span></a>
                <a href="#">隐私政策<span>丨</span></a>
                <a href="#">京东公益<span>丨</span></a>
                <a href="#">English Site<span>丨</span></a>
                <a href="#">Media & IR</a>
            </h1>
            <h2>
                <a href="#">京公网安备110000020000008B号 <span>丨</span></a>
                <a href="">京ICP证070359号<span>丨</span></a>
                <a href="">互联网药品信息服务资格证编号(京)-经营性-2014-0008<span>丨</span></a>
                <a href="">新山发京零  字第大120007号 </a>
            </h2>
            <h3>
                <a href="#">互联网出版许可证编号新出网址(京)字150号<span>丨</span></a>
                <a href="#" style="cursor: default;">出版物经营许可证<span>丨</span></a>
                <a href="#">网络文化经营许可证京网文[2014]2148 348号<span>丨</span></a>
                <a href="#">违法和不良信息举报电话:4006561155<span>丨</span></a>
            </h3>
            <h4>
                <a href="#">Copyright @ 2004-1019 京东JD.com <span>丨</span></a>
                <a href="#">消费者维权热线:4006057733 经营执照<span>丨</span></a>
                <a href="#">(京)网络平台备字(2018)第00003号<span>丨</span></a>
                <a href="#">营业执照</a>
            </h4>
            <h6>京东旗下网站:
                <a href="#">京东钱包<span>丨</span></a>
                <a href="#" >京东云</a>
                
            </h6>
            <img src="../img/img1.0/foot.png" alt="" />
        </div>
    </div>
</body>
</html>

<script>
    $(function(){
        //jquery的ajax方法
        // $.ajax({
        //     type:"POST",
        //     url:"list.json",
        //     dataType:"json",
        //     success:function(res){
        //         console.log("success")
        //     }
        // })
        $.get("list.json",function(res){
            addBox(res);
        });
    });
    function addBox(result){
        $.each(result,function(index,obj){
            console.log();
            $("#list").append(`
            <li>
            <div class="list-img"><img src="${obj.jsonimg}" alt=""> </div>
            <div class="list-id" pid="${obj.jsonid}"></div>
            <div class="list-info">${obj.jsoninfo}</div>
            <div class="list-price">${obj.jsonprice}<span class="addincar">加入购物车</span></div>
            </li>`)
        })
    }
    
    function addincar(){
    
        $("#list").on("click", ".addincar",function(e){
            var target = $(e.target);
            var _pid = target.parent().parent().children(".list-id").attr("pid");
            console.log(_pid)
            var _pname = target.parent().parent().children(".list-info").html();
            var _price = target.parent().parent().children(".list-price").html();
            var _src = target.parent().parent().children(".list-img").find("img").attr("src");
            var arr=[];
            //console.log(typeof arr)
            var json = {};
            var json = {
                "num": 1,
                "pid": _pid,
                "pname": _pname,
                "price": _price,
                "src": _src,
                "_rest_num": "100"
            }
            var shopText = localStorage.getItem("shoplist"); //console.log(JSON.parse(shopText));
            if(shopText){
               arr=JSON.parse(shopText);
            }
            // console.log( arr);
            // console.log(typeof json);
            arr.push(json);
           
            localStorage.setItem("shoplist",JSON.stringify(arr));
            console.log(arr);
           
        })
    }
    addincar();
    
    class List{
        constructor(){

        }
        init(){
           
                var xhr = null;
                if( window.XMLHttpRequest ){
                    xhr = new XMLHttpRequest();
                }else{
                    xhr = new ActiveXObject("Microsoft.XMLHTTP");
                }
                //xhr.open("GET",this.index+1 + ".txt?id="+ new Date().getTime() );
                xhr.open("GET","list.json" );
                //解决缓存问题：
                xhr.setRequestHeader( "If-Modified-Since","0" );
                xhr.send();
                xhr.onreadystatechange = function(){
                    if( xhr.readyState==4 && xhr.status==200 ){
                        console.log( xhr.responseText ) ;
                    }
                
            }
        }
    }
    //new List().init();
</script>